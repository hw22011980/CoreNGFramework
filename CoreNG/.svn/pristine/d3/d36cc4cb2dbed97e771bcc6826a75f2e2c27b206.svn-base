<ng-template #content let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">{{modalTitle}}</h4>
        <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
    <div class="modal-body">
        <form [formGroup]="formItem">
            <div formArrayName="SubItemFormArray">
                <div *ngFor="let col of selectedTableRow.Columns; index as i">
                    <div *ngIf='col.visible2'>
                    
                        <!-- TextBox -->
                        <div class="form-group row" *ngIf="col.displayDataType=='TextBox'">
                            <label for="txt{{i}}" class="col-sm-4 col-form-label">{{col.name}} </label>
                            <div class="col-sm-8">
                                <div class="input-group input-group-sm">
                                    <div class="input-group-prepend">
                                        <span *ngIf="col.prefixUnit != null && col.prefixUnit !=''" class="input-group-text justify-content-end text-primary">{{col.prefixUnit}}</span>
                                    </div>
                                    <input type="text" name="txt{{i}}" class="form-control" placeholder="enter value" [formControlName]="i" >
                                    <div class="input-group-append">
                                        <span *ngIf="col.postfixUnit != null && col.postfixUnit !=''" class="input-group-text text-primary">{{col.postfixUnit}}</span>
                                    </div>
                                </div>
                                <div *ngIf="!IsValidItem(i)">                        
                                    <span class="inputError">{{lastError}}</span>
                                </div> 
                            </div>
                        </div>

                        <!-- NumericBox -->
                        <div class="form-group row" *ngIf="col.displayDataType=='NumericBox'">
                            <label for="txt{{i}}" class="col-sm-4 col-form-label">{{col.name}} </label>
                            <div class="col-sm-8">
                                <div class="input-group input-group-sm">
                                    <div class="input-group-prepend">
                                        <span *ngIf="col.prefixUnit != null && col.prefixUnit !=''" class="input-group-text justify-content-end text-primary">{{col.prefixUnit}}</span>
                                    </div>
                                    <input type="number" name="txt{{i}}" class="form-control" placeholder="enter value" [formControlName]="i" >
                                    <div class="input-group-append">
                                        <span *ngIf="col.postfixUnit != null && col.postfixUnit !=''" class="input-group-text text-primary">{{col.postfixUnit}}</span>
                                    </div>
                                </div>
                                <div *ngIf="!IsValidItem(i)">                        
                                    <span class="inputError">{{lastError}}</span>
                                </div> 
                            </div>
                        </div>

                        <!-- DropDown list -->
                        <div class="form-group row" *ngIf="col.displayDataType=='DropDownList'">
                            <label for="opt{{i}}" class="col-sm-4 col-form-label">{{col.name}} </label>
                            <div class="col-sm-8">
                                <div class="input-group input-group-sm">
                                    <div class="input-group-prepend">
                                        <span *ngIf="col.prefixUnit != null && col.prefixUnit !=''" class="input-group-text justify-content-end text-primary">{{col.prefixUnit}}</span>
                                    </div>
                                    <select class="form-control drop-down-class" placeholder="select value" id="#opt{{i}}" name="opt{{i}}" [formControlName]="i" (change)="onDDLChangeValue($event,i)">
                                        <option *ngFor="let opt of col.availableValues" [value]="opt.value">{{opt.name}}</option>
                                    </select>
                                    <div class="input-group-append">
                                        <span *ngIf="col.postfixUnit != null && col.postfixUnit !=''" class="input-group-text text-primary">{{col.postfixUnit}}</span>
                                    </div>
                                </div>
                                <div *ngIf="!IsValidItem(i)">                        
                                    <span class="inputError">{{lastError}}</span>
                                </div>
                            </div>  
                        </div>

                        <!-- DropDown Table -->
                        <div class="form-group row" *ngIf="col.displayDataType=='DropDownTable'">
                            <!-- Register Assignment & Rate Mask list ( app-table-selector ) -->
                            <label for="{{i}}" class="col-sm-4 col-form-label">{{col.name}}</label>
                            <div class="col-sm-8">
                                <app-table-selector [formControlName]="i" name="i"  [data]="col" [rowData]="selectedTableRow" 
                                    [isEditMode]="editMode" [delimiter]="'|'" (change)="onTblSelectChange();">
                                </app-table-selector>
                            </div>
                        </div>

                        <!-- DatePicker -->
                        <div class="form-group row" *ngIf="col.displayDataType=='DateBox'">
                            <!-- Speacial Days (ngbDatepicker, only Date without time ) -->
                            <label for="dp{{i}}" class="col-sm-4 col-form-label">{{col.name}} </label>
                            <div class="col-sm-8">
                                <div class="input-group input-group-sm">
                                    <div class="input-group-prepend">
                                        <span *ngIf="col.prefixUnit != null && col.prefixUnit !=''" class="input-group-text justify-content-end text-primary">{{col.prefixUnit}}</span>
                                    </div>
                                    <input class="form-control" placeholder="dd/mm/yyyy" name="dp{{i}}" 
                                    [formControlName]="i" ngbDatepicker #d="ngbDatepicker">
                                    <div class="input-group-append">
                                        <button class="btn btn-outline-secondary" (click)="d.toggle()" type="button">
                                            <fa-icon [icon]="['far', 'calendar']"></fa-icon>
                                        </button>
                                        <span *ngIf="col.postfixUnit != null && col.postfixUnit !=''" class="input-group-text text-primary">{{col.postfixUnit}}</span>
                                    </div>
                                </div>
                                <div *ngIf="!IsValidItem(i)">                        
                                    <span class="inputError">{{lastError}}</span>
                                </div>
                            </div>
                        </div>

                        <!-- TimePicker -->
                        <div class="form-group row" *ngIf="col.displayDataType=='TimeBox'">
                            <!-- Day Profile Table ( ngb-timepicker , only time without date ) -->
                            <label for="i" class="col-sm-4 col-form-label" style="padding-top:0.25em">{{col.name}} </label>
                            <div class="col-sm-8">
                                <div class="input-group input-group-sm">
                                    <app-timepicker [formControlName]="i" name="i" [prefixUnit]="col.prefixUnit" [postfixUnit]="col.postfixUnit"></app-timepicker>
                                </div>
                                <div *ngIf="!IsValidItem(i)">                        
                                    <span class="inputError">{{lastError}}</span>
                                </div>
                            </div>
                        </div>

                        <!-- DateTimePicker -->
                        <div class="form-group row" *ngIf="col.displayDataType=='DateTimeBox'">
                            <!-- Season Profile ( app-datetimepicker, Bothdate & time together ) -->
                            <label for="{{i}}" class="col-sm-4 col-form-label">{{col.name}} </label>
                            <div class="col-sm-8">
                                <app-datetimepicker [formControlName]="i" name="i" [prefix]="col.prefixUnit" [postfix]="col.postfixUnit"></app-datetimepicker>
                                <div *ngIf="!IsValidItem(i)">                        
                                    <span class="inputError">{{lastError}}</span>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <label *ngIf="this._message" [innerHTML]="this._message" class="add_item_message"></label>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-success custom" [disabled]="!formItem.valid || !enableSave" (click)="onSave(modal)">{{saveItem}}</button>
        <button type="button" class="btn btn-mdprimary custom" (click)="onCancel(modal)">{{cancelItem}}</button>
    </div>
</ng-template>

<div>
    <button type="button" class="btn btn-primary btn-sm" (click)="openModal(content)" [disabled]="this.disable" [hidden]="!this.editable">
        {{addItem}}
    </button>
    <table class="table table-striped table-hover shadow mt-2 bg-white rounded">
        <thead>
            <tr>
            <!-- <th *ngFor="let header of tableInformation.Headers">{{header}}</th> -->
            <ng-container *ngFor="let header of tableInformation.Headers; index as c;">
                <th *ngIf="tableInformation.Visibles[c]">{{header}}</th>
            </ng-container>
            <th></th>
            <th></th>
            </tr>
        </thead>
        <tr *ngIf="tableInformation.Rows.length == 0">
            <td class="no-row" [attr.colspan]="tableInformation.Headers.length+2">There is no row in table.</td>
        </tr>
        <tr *ngFor="let row of tableInformation.Rows; index as ro;">
            <!-- <td *ngFor="let column of row.Columns">{{column.textValue}}</td> -->
            <ng-container *ngFor="let column of row.Columns; index as c;">
                <td *ngIf="tableInformation.Visibles[c]">{{column.textValue}}</td>
            </ng-container>
            <td style="width: 10px;">
                <button type="button" 
                    class="btn btn-primary custom" [disabled]="this.disable" 
                    [hidden]="!this.editable" (click)="editModal(content,row)">{{editItem}}
                </button>
            </td>
            <td style="width: 10px;">
                <button type="button" 
                    class="btn btn-mdprimary custom" [disabled]="this.disable" 
                    [hidden]="!this.editable" (click)="deleteCheck(row)">{{deleteItem}}
                </button>
            </td>
        </tr>
    </table>
</div>