<div class="row pt-5">
    <div class="col-2 pr-5 ml-4">
        <app-search (myEvent)="onSearch($event)" [searchFields]="searchModel"></app-search>
    </div>
    <div class="col-9 pl-4 text-center">
        <form [formGroup]="sitelistForm" (ngSubmit)="addNewSite()">
            <div class="row">
                <div class="col-11 input-group mb-2">
                    <button type="submit" class="mr-2 btn btn-outline-primary" [disabled]='edit'>
                        Create Site
                    </button>
                    <div class="custom-file">
                        <input type="text" class="form-control" id="siteName" formControlName="siteName"
                            placeholder="Enter New Site Name" [readonly]='edit'>
                    </div>
                    <div class="input-group-append">
                        <button class="btn btn-outline-primary" type="button" (click)="clear()" [disabled]='edit'>Clear</button>
                    </div>
                </div>
                <!-- <app-spinner class="col-1" *ngIf="spinnerService.getloading(deviceService.getDevicesRequestUrl())">
                    </app-spinner> -->
            </div>
            <hr>
            <!-- <div *ngIf="!spinnerService.getloading(deviceService.getDevicesRequestUrl())"></div> -->
            <div>
                <div *ngIf="!sites?.length; else showTable">
                    <h3>No sites found </h3>
                    <hr>
                </div>
            </div>
        </form>

        <ng-template #showTable>
            <table class="table table-striped table-hover shadow p-3 mb-5 bg-white table-width rounded">
                <thead>
                    <tr>
                        <th style="width:8%" class="v-align">ID</th>
                        <th style="width: 35%;">SITE NAME</th>
                        <th style="width: 19%">NUMBER OF DEVICES</th>
                        <th style="text-align: right;">
                            <div class="mr-3">
                                <button *ngIf="edit" type="button" class="btn btn-success btn-sm ml-5" id="apply"
                                    (click)="edit=false; onEditSites()">Apply</button>
                                <button *ngIf="edit" type="button" class="btn btn-danger btn-sm ml-3"
                                    data-toggle="tooltip" (click)="edit=false; resetSites();">Cancel</button>
                                <button *ngIf="!edit" type="button" class="btn btn-light btn-sm" data-toggle="tooltip"
                                    (click)="edit=true;">Edit...</button>
                            </div>
                        </th>
                    </tr>
                </thead>
                <tr *ngFor="let site of pagedItems" [ngClass]="{'pointer': !edit}" (click)="routeLink(site)">
                    <td>{{ site.siteID}}</td>
                    <td>
                        <span *ngIf="!edit || site.siteID == 0 ">{{ site.siteName}}</span>
                        <input *ngIf="edit && site.siteID != 0" type="text" class="form-control input-sm"
                            [(ngModel)]="site.siteName" (change)="onSiteChange()">
                    </td>
                    <td>{{ site.numberofDevices }}</td>
                    <td style="text-align: right;">
                        <button *ngIf="edit && site.siteID != 0" type="button" class="btn btn-delete btn-sm mr-5"
                            data-toggle="tooltip" (click)="deleteSiteOnList(site);">Delete</button>
                    </td>
                </tr>
            </table>
            <nav>
                <ul class="pagination justify-content-center" *ngIf="pager.pages && pager.pages.length">
                    <li class="page-item" [ngClass]="{disabled:pager.currentPage === 1}">
                        <a class="page-link" (click)="setPage(1,true)">First</a>
                    </li>
                    <li class="page-item" [ngClass]="{disabled:pager.currentPage === 1}">
                        <a class="page-link" (click)="setPage(pager.currentPage - 1,true)">Previous</a>
                    </li>
                    <li class="page-item" *ngFor="let page of pager.pages"
                        [ngClass]="{active:pager.currentPage === page}">
                        <a class="page-link" style="width: 65px" (click)="setPage(page,true)">{{page}}</a>
                    </li>
                    <li class="page-item" [ngClass]="{disabled:pager.currentPage === pager.totalPages}">
                        <a class="page-link" (click)="setPage(pager.currentPage + 1,true)">Next</a>
                    </li>
                    <li class="page-item" [ngClass]="{disabled:pager.currentPage === pager.totalPages}">
                        <a class="page-link" (click)="setPage(pager.totalPages,true)">Last</a>
                    </li>
                </ul>
            </nav>
        </ng-template>
    </div>
</div>